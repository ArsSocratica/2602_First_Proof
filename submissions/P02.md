# Problem 2 — Universal Test Vectors for Rankin–Selberg Integrals

## Problem Statement

Let $F$ be a non-archimedean local field with ring of integers $\mathfrak{o}$, maximal ideal $\mathfrak{p} = \varpi \mathfrak{o}$, and residue field of cardinality $q$. Let $\psi: F \to \mathbb{C}^\times$ be a nontrivial additive character of conductor $\mathfrak{o}$, identified in the standard way with a generic character of $N_r$.

Let $\Pi$ be a generic irreducible admissible representation of $\mathrm{GL}_{n+1}(F)$, realized in its $\psi^{-1}$-Whittaker model $\mathcal{W}(\Pi, \psi^{-1})$. Must there exist $W \in \mathcal{W}(\Pi, \psi^{-1})$ with the following property?

> For every generic irreducible admissible $\pi$ of $\mathrm{GL}_n(F)$ in its $\psi$-Whittaker model $\mathcal{W}(\pi, \psi)$, with conductor ideal $\mathfrak{q}$ and $Q \in F^\times$ a generator of $\mathfrak{q}^{-1}$, setting $u_Q := I_{n+1} + Q E_{n,n+1}$, there exists $V \in \mathcal{W}(\pi, \psi)$ such that $\int_{N_n \backslash \mathrm{GL}_n(F)} W(\mathrm{diag}(g,1) u_Q) V(g) |\det g|^{s-1/2} dg$ is finite and nonzero for all $s \in \mathbb{C}$.

**Answer: YES** — a universal test vector exists.

---

## Proof

The proof has three ingredients: an algebraic reduction (Lemma 1), an analytic trick (single-coset Kirillov support → monomial in $q^{-s}$), and a representation-theoretic existence argument (countable union of proper subspaces).

We fix $Q = \varpi^{-c}$ where $\mathfrak{q} = \mathfrak{p}^c$; the result for any other generator follows since $\psi^{-1}(uQ \cdot)$ has the same conductor as $\psi^{-1}(Q \cdot)$ for $u \in \mathfrak{o}^\times$.

### 1. The $u_Q$-twist formula

**Lemma 1.** For $g \in \mathrm{GL}_n(F)$ and $Q \in F^\times$:

$$W(\mathrm{diag}(g,1) \, u_Q) = \psi^{-1}(Q \, g_{nn}) \, W(\mathrm{diag}(g,1)).$$

*Proof.* Conjugate $u_Q$ past $\mathrm{diag}(g,1)$:

$$\mathrm{diag}(g,1) \cdot u_Q = \left(I_{n+1} + Q \sum_{i=1}^n g_{in} E_{i,n+1}\right) \cdot \mathrm{diag}(g,1).$$

The left factor is in $N_{n+1}$. The generic character $\psi^{-1}$ reads only superdiagonal entries $(i,i+1)$; the only such contribution is position $(n, n+1)$ with entry $Q g_{nn}$. $\square$

**Corollary.** The Rankin–Selberg integral becomes:

$$\Psi(s, W, V) = \int_{N_n \backslash \mathrm{GL}_n(F)} \psi^{-1}(Q g_{nn}) W(\mathrm{diag}(g,1)) V(g) |\det g|^{s-1/2} dg.$$

Note: $g_{nn}$ is well-defined on $N_n \backslash \mathrm{GL}_n$ since left multiplication by upper-triangular unipotent matrices preserves the $(n,n)$-entry.

### 2. Construction of $W$ via the Kirillov model

Define $\Phi_W(g) := W(\mathrm{diag}(g, 1))$ for $g \in \mathrm{GL}_n(F)$. By the Bernstein–Zelevinsky structure theorem [BZ77, Theorem 5.21], the map $W \mapsto \Phi_W$ surjects onto $\mathrm{c\text{-}ind}_{N_n}^{\mathrm{GL}_n}(\psi^{-1})$.

Fix $N \geq 0$. Choose $W$ so that $\Phi_W$ is:
- Supported on $N_n \varpi^{-N} K_n$
- Right-$K_n$-invariant
- Normalized: $\Phi_W(\varpi^{-N} I_n) = 1$

### 3. Evaluation: monomial structure

On the support $N_n \varpi^{-N} K_n$, writing $g = n \cdot \varpi^{-N} k$: the factors $\psi^{-1}(n)$ from $\Phi_W$ and $\psi(n)$ from $V$ cancel, $|\det g| = q^{nN}$ is constant, and $g_{nn} = \varpi^{-N} k_{nn}$. So:

$$\Psi(s, W, V) = q^{nN(s-1/2)} \cdot \ell(V), \quad \ell(V) := \int_{K_n} \psi^{-1}(\varpi^{-(c+N)} k_{nn}) V(\varpi^{-N} k) \, dk.$$

Since $q^{nN(s-1/2)} \neq 0$ for all $s$, it suffices to show $\ell(V) \neq 0$ for some $V$.

### 4. Nonvanishing of $\ell$ (Lemma 2)

**Lemma 2.** For any generic irreducible admissible $\pi$ of $\mathrm{GL}_n(F)$ and any $N \geq 0$, there exists $V \in \mathcal{W}(\pi, \psi)$ with $\ell(V) \neq 0$.

*Proof.* By §1, $\ell(V) = q^{-nN(s-1/2)} \Psi_{\mathrm{std}}(s, W^Q, V)$ where $W^Q = \Pi(u_Q) W$. So $\ell \equiv 0$ iff $W^Q \in \mathrm{Rad}_L(\pi)$, the left radical:

$$\mathrm{Rad}_L(\pi) := \{W' \in \mathcal{W}(\Pi, \psi^{-1}) : \Psi_{\mathrm{std}}(s, W', V) = 0 \text{ for all } V, \text{ all } s\}.$$

**Step 1.** $\mathrm{Rad}_L(\pi)$ is **proper**: by JPSS [JPSS83, Theorem 2.7], there exist $W_0, V_0$ with $\Psi_{\mathrm{std}}(s, W_0, V_0) = L(s, \Pi \times \pi) \neq 0$.

**Step 2.** The **bad locus** $\mathcal{B}_\pi := \Pi(u_Q)^{-1} \mathrm{Rad}_L(\pi)$ is a proper subspace (since $\Pi(u_Q)$ is an automorphism).

**Step 3.** $\mathcal{B}_\pi$ depends only on the **inertial equivalence class** $[\pi]$ (orbit under unramified twists $\pi \mapsto \pi \otimes |\det|^s$):
- The conductor $c(\pi)$ is unchanged by unramified twists, so $u_Q$ depends only on $[\pi]$.
- For $\pi' = \pi \otimes |\det|^s$, $V'(g) = V(g)|\det g|^s$, so $\Psi_{\mathrm{std}}(s_0, W', V') = \Psi_{\mathrm{std}}(s_0 + s, W', V)$, hence $\mathrm{Rad}_L(\pi') = \mathrm{Rad}_L(\pi)$.

The inertial classes are **countable**: parametrized by a partition of $n$ and a tuple of supercuspidal representations (up to unramified twist) of smaller $\mathrm{GL}$'s.

**Step 4.** A vector space over $\mathbb{C}$ cannot be a countable union of proper subspaces [La02, Ch. III, Ex. 17]. So $\mathcal{W}(\Pi, \psi^{-1}) \neq \bigcup_{[\pi]} \mathcal{B}_{[\pi]}$, and there exists $W$ with $W^Q \notin \mathrm{Rad}_L(\pi)$ for all $\pi$. $\square$

### 5. Universality: combining with the monomial structure

Argument 1 gives $W_0$ with $\Pi(u_Q) W_0 \notin \mathrm{Rad}_L(\pi)$ for all $\pi$, but $W_0$ may not have single-coset support (so $\Psi$ could be a Laurent polynomial with zeros).

Define $\mathcal{S}_N := \{W \in \mathcal{W}(\Pi, \psi^{-1}) : \Phi_W \text{ supported on } N_n \varpi^{-N} K_n\}$. By BZ surjectivity, $\mathcal{S}_N$ is infinite-dimensional. Every $W \in \mathcal{S}_N$ gives a monomial $\Psi(s) = q^{nN(s-1/2)} \cdot \ell(V)$.

For each $[\pi]$, $\mathcal{S}_N \cap \mathcal{B}_{[\pi]}$ is **proper** in $\mathcal{S}_N$: if $\mathcal{S}_N \subset \mathcal{B}_{[\pi]}$, then $\ell_W(V) = 0$ for all $W \in \mathcal{S}_N$ and all $V$. Since $V(\varpi^{-N} k)$ and $\psi^{-1}(\varpi^{-(c+N)} k_{nn})$ are locally constant, there exists a congruence subgroup $K' \subset K_n$ making both right-$K'$-invariant. Taking $\Phi_W(\varpi^{-N} k) = \mathrm{vol}(K')^{-1} \cdot \mathbf{1}_{K'}(k)$ gives $\ell_W(V) = \psi^{-1}(\varpi^{-(c+N)}) V(\varpi^{-N})$. This vanishing for all $V$ contradicts Whittaker separation.

So $\{\mathcal{S}_N \cap \mathcal{B}_{[\pi]}\}_{[\pi]}$ is a countable family of proper subspaces of $\mathcal{S}_N$, and there exists $W \in \mathcal{S}_N \setminus \bigcup_{[\pi]} \mathcal{B}_{[\pi]}$: a single-coset vector with $\ell(V) \neq 0$ for some $V$, for each $\pi$. $\square$

---

## References

1. **[BZ77]** I.N. Bernstein, A.V. Zelevinsky, "Induced representations of reductive p-adic groups. I," *Ann. Sci. ENS* **10** (1977), 441–472.
2. **[JPSS83]** H. Jacquet, I.I. Piatetski-Shapiro, J.A. Shalika, "Rankin–Selberg convolutions," *Amer. J. Math.* **105** (1983), 367–464.
3. **[La02]** S. Lang, *Algebra*, 3rd ed., GTM **211**, Springer, 2002.
